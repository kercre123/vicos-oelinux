From 3c0239afaab797d2ab9f93d015f4cebf05726521 Mon Sep 17 00:00:00 2001
From: Brian Chapados <chapados@anki.com>
Date: Wed, 22 Aug 2018 02:41:59 -0700
Subject: [PATCH 1/2] Skip calling xtables_insmod

It always fails on our system and is crashing in connman-1.36
---
 src/iptables.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/src/iptables.c b/src/iptables.c
index 5ef757a..e21ee5b 100644
--- a/src/iptables.c
+++ b/src/iptables.c
@@ -1465,6 +1465,8 @@ static void table_cleanup(struct connman_iptables *table)
 	g_free(table);
 }
 
+#define ENABLE_XTABLES_INSMOD 0
+
 static struct connman_iptables *iptables_init(const char *table_name)
 {
 	struct connman_iptables *table = NULL;
@@ -1473,6 +1475,7 @@ static struct connman_iptables *iptables_init(const char *table_name)
 
 	DBG("%s", table_name);
 
+#if ENABLE_XTABLES_INSMOD
 	if (xtables_insmod("ip_tables", NULL, TRUE) != 0)
 		DBG("ip_tables module loading gives error but trying anyway");
 
@@ -1484,6 +1487,7 @@ static struct connman_iptables *iptables_init(const char *table_name)
 		DBG("%s module loading gives error but trying anyway", module);
 
 	g_free(module);
+#endif
 
 	table = g_try_new0(struct connman_iptables, 1);
 	if (!table)
-- 
2.1.2

